replicas=( 54.174.6.90 54.149.9.25 54.67.86.61 54.72.167.104 54.93.182.67 54.169.146.226 54.65.104.220 54.66.212.131 54.94.156.232 )
#replicas=( ec2-54-174-6-90.compute-1.amazonaws.com ec2-54-149-9-25.us-west-2.compute.amazonaws.com)
#http://wiki.bash-hackers.org/howto/getopts_tutorial
while getopts ":p:o:n:u:i:" opt; do
  case $opt in
    u) username=$OPTARG ;;
    i) keyfile=$OPTARG ;;
   	p) port=$OPTARG ;;
   	o) origin=$OPTARG ;;
   	n) name=$OPTARG;;
    ?)
      echo "Invalid option"
      exit 1
      ;;
  esac
done
for replica in "${replicas[@]}";
do
	ssh -i $keyfile $username@$replica "sh -c 'nohup ./httpserver -o $origin -p $port > /dev/null 2>&1 &'"
	ssh -i $keyfile $username@$replica "sh -c 'nohup python probe.py > /dev/null 2>&1 &'"
	echo "started HTTP in $replica"
done;

ssh -i $keyfile $username@cs5700cdnproject.ccs.neu.edu "sh -c 'nohup ./dnsserver -p $port -n $name > /dev/null 2>&1 &'"
echo "started DNS server"